<?xml version="1.0"?>
<!--
  Dashboard Screen

  Demonstrates:
  - Screen-level component
  - Using services (UserService)
  - Using other custom components (UserCard)
-->
<Screen
    xmlns:fx="http://ns.adobe.com/mxml/2009"
    xmlns:s="library://ns.adobe.com/flex/spark"
    xmlns:components="components.*">

    <fx:Script>
        <![CDATA[
            import services.UserService;

            [Bindable]
            private var users:Vector.<User> = new Vector.<User>();

            [Bindable]
            private var loading:Boolean = false;

            // Called when screen becomes visible
            public function onActivate():void {
                loadUsers();
            }

            private async function loadUsers():Promise<void> {
                loading = true;
                try {
                    users = await UserService.getAll();
                } catch (error:Error) {
                    trace("Error loading users:", error.message);
                } finally {
                    loading = false;
                }
            }
        ]]>
    </fx:Script>

    <s:VBox width="100%" height="100%" gap="20">
        <s:Label text="Dashboard" fontSize="28" fontWeight="bold"/>

        <!-- Stats cards -->
        <s:HBox gap="20">
            <components:StatCard
                title="Total Users"
                value="{users.length}"
                icon="users"/>

            <components:StatCard
                title="Active"
                value="{getActiveCount()}"
                icon="check"/>
        </s:HBox>

        <!-- Loading indicator -->
        <s:Label
            text="Loading users..."
            visible="{loading}"
            fontSize="16"
            color="#7f8c8d"/>

        <!-- User list -->
        <s:VBox gap="10" visible="{!loading}">
            <s:Label text="Recent Users" fontSize="18" fontWeight="bold"/>

            <!-- In real app, we'd iterate with repeater -->
            <s:Label text="User list would go here (use DataGrid or custom UserCard components)"/>
        </s:VBox>
    </s:VBox>

</Screen>
