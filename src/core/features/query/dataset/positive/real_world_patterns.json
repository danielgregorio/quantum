[
  {
    "description": "User dashboard with stats",
    "code": "<q:query name=\"stats\" datasource=\"app-db\">\n    SELECT COUNT(*) as total, SUM(total_amount) as revenue FROM orders WHERE user_id = :uid\n    <q:param name=\"uid\" value=\"{current_user_id}\" type=\"integer\" />\n</q:query>\n<div class=\"dashboard\">\n  <h2>My Dashboard</h2>\n  <div>Total Orders: {stats.total}</div>\n  <div>Total Revenue: ${stats.revenue}</div>\n</div>",
    "expected_behavior": "Displays user's order count and total revenue in a dashboard widget",
    "use_case": "Real-time business intelligence dashboards"
  },
  {
    "description": "Product catalog with pagination",
    "code": "<q:set name=\"page\" value=\"1\" />\n<q:set name=\"per_page\" value=\"20\" />\n<q:set name=\"offset\" value=\"({page} - 1) * {per_page}\" />\n<q:query name=\"products\" datasource=\"app-db\">\n    SELECT * FROM products ORDER BY created_at DESC LIMIT :limit OFFSET :offset\n    <q:param name=\"limit\" value=\"{per_page}\" type=\"integer\" />\n    <q:param name=\"offset\" value=\"{offset}\" type=\"integer\" />\n</q:query>\n<div class=\"products\">\n  <q:loop items=\"{products}\" var=\"product\">\n    <div class=\"product-card\">\n      <h3>{product.name}</h3>\n      <p>${product.price}</p>\n    </div>\n  </q:loop>\n</div>",
    "expected_behavior": "Shows paginated product list with 20 items per page",
    "use_case": "E-commerce product browsing with pagination"
  },
  {
    "description": "Search functionality with filters",
    "code": "<q:set name=\"search_query\" value=\"{user_input}\" />\n<q:set name=\"min_price\" value=\"{filter_min_price}\" />\n<q:set name=\"max_price\" value=\"{filter_max_price}\" />\n<q:query name=\"searchResults\" datasource=\"app-db\">\n    SELECT * FROM products WHERE name LIKE :query AND price BETWEEN :min AND :max ORDER BY relevance DESC\n    <q:param name=\"query\" value=\"{search_query}\" type=\"string\" />\n    <q:param name=\"min\" value=\"{min_price}\" type=\"decimal\" />\n    <q:param name=\"max\" value=\"{max_price}\" type=\"decimal\" />\n</q:query>\n<div class=\"search-results\">\n  <h3>Found {searchResults_result.recordCount} products</h3>\n  <q:loop items=\"{searchResults}\" var=\"product\">\n    <div>{product.name} - ${product.price}</div>\n  </q:loop>\n</div>",
    "expected_behavior": "Performs filtered search with price range and displays results with count",
    "use_case": "Product search with multiple filters"
  },
  {
    "description": "Shopping cart total calculation",
    "code": "<q:query name=\"cartItems\" datasource=\"app-db\">\n    SELECT p.name, p.price, c.quantity FROM cart c JOIN products p ON c.product_id = p.id WHERE c.user_id = :uid\n    <q:param name=\"uid\" value=\"{current_user_id}\" type=\"integer\" />\n</q:query>\n<q:set name=\"cart_total\" value=\"0\" />\n<div class=\"cart\">\n  <h2>Shopping Cart</h2>\n  <q:loop items=\"{cartItems}\" var=\"item\">\n    <div class=\"cart-item\">\n      <span>{item.name}</span>\n      <span>Qty: {item.quantity}</span>\n      <span>${item.price * item.quantity}</span>\n    </div>\n    <q:set name=\"cart_total\" value=\"{cart_total} + ({item.price} * {item.quantity})\" />\n  </q:loop>\n  <div class=\"cart-total\">Total: ${cart_total}</div>\n</div>",
    "expected_behavior": "Displays cart items with individual totals and calculates grand total",
    "use_case": "E-commerce shopping cart with JOIN query and total calculation"
  },
  {
    "description": "User profile with recent activity",
    "code": "<q:query name=\"user\" datasource=\"app-db\">\n    SELECT * FROM users WHERE id = :id\n    <q:param name=\"id\" value=\"{user_id}\" type=\"integer\" />\n</q:query>\n<q:query name=\"recentActivities\" datasource=\"app-db\">\n    SELECT * FROM activities WHERE user_id = :uid ORDER BY created_at DESC LIMIT 5\n    <q:param name=\"uid\" value=\"{user_id}\" type=\"integer\" />\n</q:query>\n<div class=\"profile\">\n  <h2>{user.name}</h2>\n  <p>Email: {user.email}</p>\n  <p>Member since: {user.created_at}</p>\n  <h3>Recent Activity</h3>\n  <q:loop items=\"{recentActivities}\" var=\"activity\">\n    <div>{activity.type}: {activity.description} ({activity.created_at})</div>\n  </q:loop>\n</div>",
    "expected_behavior": "Shows user profile with their 5 most recent activities",
    "use_case": "User profile page with activity feed"
  },
  {
    "description": "Dynamic report generation",
    "code": "<q:set name=\"report_type\" value=\"'monthly'\" />\n<q:set name=\"start_date\" value=\"'2024-01-01'\" />\n<q:set name=\"end_date\" value=\"'2024-01-31'\" />\n<q:query name=\"salesReport\" datasource=\"app-db\">\n    SELECT DATE(created_at) as date, COUNT(*) as orders, SUM(total_amount) as revenue FROM orders WHERE created_at BETWEEN :start AND :end GROUP BY DATE(created_at) ORDER BY date\n    <q:param name=\"start\" value=\"{start_date}\" type=\"datetime\" />\n    <q:param name=\"end\" value=\"{end_date}\" type=\"datetime\" />\n</q:query>\n<div class=\"report\">\n  <h2>Sales Report - {report_type}</h2>\n  <table>\n    <thead><tr><th>Date</th><th>Orders</th><th>Revenue</th></tr></thead>\n    <tbody>\n      <q:loop items=\"{salesReport}\" var=\"row\">\n        <tr>\n          <td>{row.date}</td>\n          <td>{row.orders}</td>\n          <td>${row.revenue}</td>\n        </tr>\n      </q:loop>\n    </tbody>\n  </table>\n</div>",
    "expected_behavior": "Generates sales report grouped by date with aggregated metrics",
    "use_case": "Business reporting with GROUP BY and aggregations"
  },
  {
    "description": "Inventory alert system",
    "code": "<q:query name=\"lowStockProducts\" datasource=\"app-db\">\n    SELECT * FROM products WHERE stock_quantity &lt; :threshold\n    <q:param name=\"threshold\" value=\"10\" type=\"integer\" />\n</q:query>\n<q:if condition=\"{lowStockProducts_result.recordCount} > 0\">\n  <div class=\"alert alert-warning\">\n    <h3>Low Stock Alert</h3>\n    <p>{lowStockProducts_result.recordCount} products need restocking</p>\n    <ul>\n      <q:loop items=\"{lowStockProducts}\" var=\"product\">\n        <li>{product.name}: {product.stock_quantity} units remaining</li>\n      </q:loop>\n    </ul>\n  </div>\n</q:if>",
    "expected_behavior": "Shows alert when products fall below stock threshold",
    "use_case": "Inventory management and automated alerts"
  },
  {
    "description": "Comment thread with nested replies",
    "code": "<q:query name=\"topComments\" datasource=\"app-db\">\n    SELECT * FROM comments WHERE post_id = :pid AND parent_id IS NULL ORDER BY created_at DESC\n    <q:param name=\"pid\" value=\"{post_id}\" type=\"integer\" />\n</q:query>\n<div class=\"comments\">\n  <q:loop items=\"{topComments}\" var=\"comment\">\n    <div class=\"comment\">\n      <div class=\"author\">{comment.author_name}</div>\n      <div class=\"content\">{comment.content}</div>\n      <div class=\"timestamp\">{comment.created_at}</div>\n      <q:query name=\"replies\" datasource=\"app-db\">\n          SELECT * FROM comments WHERE parent_id = :cid ORDER BY created_at\n          <q:param name=\"cid\" value=\"{comment.id}\" type=\"integer\" />\n      </q:query>\n      <q:if condition=\"{replies_result.recordCount} > 0\">\n        <div class=\"replies\">\n          <q:loop items=\"{replies}\" var=\"reply\">\n            <div class=\"reply\">{reply.author_name}: {reply.content}</div>\n          </q:loop>\n        </div>\n      </q:if>\n    </div>\n  </q:loop>\n</div>",
    "expected_behavior": "Displays comment thread with nested replies using parent-child relationship",
    "use_case": "Discussion forums and comment systems"
  },
  {
    "description": "Customer order history with status",
    "code": "<q:query name=\"orderHistory\" datasource=\"app-db\">\n    SELECT o.*, COUNT(oi.id) as item_count FROM orders o LEFT JOIN order_items oi ON o.id = oi.order_id WHERE o.user_id = :uid GROUP BY o.id ORDER BY o.created_at DESC\n    <q:param name=\"uid\" value=\"{current_user_id}\" type=\"integer\" />\n</q:query>\n<div class=\"order-history\">\n  <h2>My Orders</h2>\n  <q:loop items=\"{orderHistory}\" var=\"order\">\n    <div class=\"order\">\n      <div>Order #{order.id} - {order.status}</div>\n      <div>{order.item_count} items - Total: ${order.total_amount}</div>\n      <div>Placed: {order.created_at}</div>\n    </div>\n  </q:loop>\n</div>",
    "expected_behavior": "Shows user's order history with item count from JOIN and GROUP BY",
    "use_case": "Customer account order history page"
  },
  {
    "description": "Real-time analytics dashboard",
    "code": "<q:query name=\"todayMetrics\" datasource=\"app-db\">\n    SELECT (SELECT COUNT(*) FROM users WHERE created_at >= CURRENT_DATE) as new_users, (SELECT COUNT(*) FROM orders WHERE created_at >= CURRENT_DATE) as new_orders, (SELECT SUM(total_amount) FROM orders WHERE created_at >= CURRENT_DATE) as daily_revenue\n</q:query>\n<div class=\"dashboard\">\n  <h2>Today's Metrics</h2>\n  <div class=\"metric-card\">\n    <h3>New Users</h3>\n    <div class=\"value\">{todayMetrics.new_users}</div>\n  </div>\n  <div class=\"metric-card\">\n    <h3>New Orders</h3>\n    <div class=\"value\">{todayMetrics.new_orders}</div>\n  </div>\n  <div class=\"metric-card\">\n    <h3>Revenue</h3>\n    <div class=\"value\">${todayMetrics.daily_revenue}</div>\n  </div>\n</div>",
    "expected_behavior": "Displays real-time daily metrics using subqueries for multiple aggregations",
    "use_case": "Executive dashboard with multiple KPIs"
  }
]
